---
title: "A Step-by-Step Guide to Building an AWS CI/CD Pipeline with CodeCommit, CodeBuild,CodeDeploy,S3, CodePipeline"
datePublished: Tue Jul 25 2023 04:36:11 GMT+0000 (Coordinated Universal Time)
cuid: clkht0yi2000309mf71vr9ohg
slug: a-step-by-step-guide-to-building-an-aws-cicd-pipeline-with-codecommit-codebuildcodedeploys3-codepipeline
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1689607217916/a79b1f2c-b6a7-46fc-9b0a-3bfc4cf8522d.webp
tags: aws, devops, ci-cd, aws-certified-solutions-architect-associate, aws-cicd-devops-project

---

### **Let us know about AWS Code........ :**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689997610445/bc832c59-6916-47ae-b7c4-8073fa03fc84.webp align="center")

**AWS CodeCommit** : is a managed Git repository service that allows companies to securely host and manage their codebase. With built-in features like code reviews, pull requests, and seamless integration with other AWS services, it provides a reliable and collaborative environment for developers to version control their code.

**AWS CodeBuild :** is a fully-managed continuous integration service that automates the build process. Developers can compile, test, and package their code with ease, leading to faster software delivery cycles and reduced manual errors. The service scales effortlessly, ensuring efficient handling of varying workloads.

**AWS CodeDeploy :** streamlines application deployment by automating the process and supporting various deployment strategies. With controlled updates and minimal downtime, CodeDeploy ensures high availability of applications across multiple environments, both on-premises and in the cloud.

**AWS CodePipeline :** is a managed CI/CD service that enables developers to create customizable pipelines for building, testing, and deploying code changes. It orchestrates the entire release process, from source code changes to deployment, providing faster software delivery, increased collaboration, and consistent deployments through seamless integration with AWS services.

## **Step - 1 :**

To set up a code repository on CodeCommit and clone it on your local.

Login to AWS account by using valid credentials. Search “CodeCommit” from the search box and click on it. Click on “Create repository”.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998549042/b76d6b8d-e256-4f22-b072-5de4f5c3b83c.webp align="center")

Now you can fill in the repo name description and create the repository

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998599544/c53b31b9-cb66-4d79-bc32-8d06568d3ee9.webp align="center")

As you can see the repository is successfully created but me being a root user I cannot do ssh so to sort this out I will be creating an AMI user account and providing some permissions

For that, I will be going to the Services section in the AWS Management Console and searching for IAM

### **IAM( Identity and Access Management)**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998680566/c06cdab3-2edc-41a1-aa14-32d19246fe1d.webp align="center")

### **Now I have created the AMI user using my requirements as follows**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998719128/4f6d11a5-5fbc-4153-b08e-b2b1c5d8e0ae.webp align="center")

### **I have given the Console password as the Autogenerated password and made it visible and created my AMI user**

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998900462/28a2326b-7206-4626-bafa-20f63fb821d0.webp align="center")

The above are my HTTP Git credentials where I have generated credentials which will be used to check in as an IAM

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998924068/783ae900-d212-459a-b439-292e216264ef.webp align="center")

I have downloaded the .csv and saved it in my local , which I am going to use while performing ssh using the clone URL

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998957848/c8fc0ba3-5e5a-4663-9135-970a8ceef5f5.webp align="center")

1. I have copied the URL and Clicked on the third icon from the left in VS Code. On top, 3 dots will appear. Click on three dots. The “Remote” option will come. Under that “**Add Remote**” will be visible and click on it
    
2. Enter cloned repository URL.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689998988401/f8fe58f5-5d17-4f23-98eb-be4400251e49.webp align="center")
    
3. Enter the username from the file which you downloaded earlier.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689999049016/c2af1f39-c13e-43a3-8773-ad59ce0c1dd9.webp align="center")
    
4. Enter the password from the file which you downloaded earlier. Click on the **“Enter”** button from your keyboard.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689999481934/1f4e1a99-92df-425b-ab82-b3bbc6aa2e0c.webp align="center")
    
    Click on “**Add permissions**” dropdown and click on “**Add permissions**”.
    

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1689999371490/ad131e93-0cc7-4fbc-bc6d-5f02e9441478.webp align="center")

1. Click on “**Next**”.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257419437/6a45088b-a27a-4e61-824d-8464ccedf4c7.webp align="center")
    
2. Click on “**Add permissions**”.
    
3. Your policy will be created and added to your user.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257475845/95d94c9f-8544-4d15-81db-7e45daf193dd.webp align="center")
    

## **Step - 2 :**

### **Add a new file from local and commit to your local branch.**

1. Go to your VS Code. Clone your repository from CodeCommit using the command “**git clone &lt;repository\_url&gt;**”. Make a new file “**index.html**” and write desired code in it as given below in the screenshot.
    

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257666795/d0822d07-da60-43b3-b83b-31a647bced31.webp align="center")

2\. Enter the command “git status”, “git add .”, “git comit -m “&lt;any\_message&gt;””.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257823052/20186fd9-a907-40ca-a029-03a48184defe.png align="center")

### Push the local changes to the CodeCommit repository.

1. Enter the command “**git push origin master**” to push the newly made file locally to the CodeCommit repository.
    
2. ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257939867/f94c8f16-d1b5-44bf-afe1-1072a6078de7.png align="center")
    

Open CodeCommit. Go to your repository and click on it.

You will be able to see “**index.html**” file in your repository.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690257984760/2c6b6512-8a90-4c2d-a2fe-fcf654cffb9d.png align="center")

## **Step - 3 :**

1. Go to CodeBuild in AWS.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258049203/f743ec9b-64aa-4bf2-835f-efb7047df748.png align="center")
    

2\. Enter mandatory details like the Project name.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258071130/1e939499-b332-4b6b-923e-801d010718b9.png align="center")

3\. Choose “**AWS CodeCommit**” from the “**Source provider**” dropdown box

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258099752/73c71760-785a-45c9-aec0-abee3e5e4d33.png align="center")

4\. Choose the repository which you had already created.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258126426/878e3ae1-c28d-4ecb-b602-bdb517628c9d.png align="center")

5\. Choose a **Branch** as “**master**”

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258150349/9c19ab6a-ce73-4da1-a1b6-ea68e864c8b7.png align="center")

6 . Choose the **Operating system** “**Ubuntu**”.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258172629/84c2bc50-634e-44af-b212-826b85f9cfdb.png align="center")

7\. Choose Image as the latest one available from the “Image” dropdown.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258194144/0247794f-7f0b-4c5d-abc5-60431775d478.png align="center")

1. Select the Use a buildspec file and create one like buildspec.yml
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258247291/3b934803-199c-4bbe-8b14-7ffa303fc067.png align="center")
    

* Add buildspec.yml file to CodeCommit Repository and complete the build process.
    
* Go to your VS Code. Make a file with the name “**buildspec.yml**”. Add configurations to install nginx as given below in the screenshot and save the file.
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258386068/8d0a7995-a3eb-46e5-9f19-daf0e280d1ad.webp align="center")
    

9 . Enter commands: “**git add buildspec.yml**”, “**git commit -m &lt;”any\_message”&gt;**” and “**git push origin master**”

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258446351/337f4cd4-09ce-427b-8731-cd1d103caf5c.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258454126/513faf20-d3c9-4b92-8871-3ec7ffbefaaf.png align="center")

The buildspec.yml file will be visible in CodeCommit.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258482694/3b60a6d6-0397-44fe-bf2e-270952a306f3.png align="center")

10 . Go back to CodeBuild where you left. Scroll down and click on “**Create build project**”.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258504162/f7efe2d9-81c4-4bda-ba32-a53e10f86b79.png align="center")

11 . Your project will be created successfully. Click on “**Start to build**”.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258542812/621d9c90-60f9-4e6d-ab0f-0031caefb995.png align="center")

12 . Project will start building.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258634433/8fe70955-4bda-49e9-b0ff-d0e8644235b0.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258646413/2c4b7433-ba5d-4ffe-a558-62d41efdb49f.png align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258654102/333bb027-b22c-449c-aeb8-ad9d914f559e.png align="center")

13 . After some time, the project will be built successfully.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258698996/fbf0e0f5-61d7-42b5-bf99-56a020e72c5a.png align="center")

### **Step - 4 :**

Go to Developer tools in CodeDeploy and search for applications and then create an application

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258728935/bc7687bf-eaea-43af-b0bc-38a12f905429.webp align="center")

To deploy an app in multiple servers we need a group called as deployment group so we will create it

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258754068/8f62b90e-0004-49c2-b21a-2a5d43270339.webp align="center")

we need to attach a service role so we will select the code deployment role in our IAM role and check for the permissions

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258770417/1e34bacc-50a7-41cb-aa80-2910dc07cda4.webp align="center")

After creating the deployment group go to the search box and search for EC2 and create a new instance and select Ubuntu as an OS provider and launch it

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258792376/5498dc68-a9c2-40ff-88c7-cfa82fddbfe1.webp align="center")

Update security groups and give the keys and values for the tags

In order to deploy your app to EC2, CodeDeploy needs an agent which actually deploys the code on your EC2.

So let's set it up.

Create a shell script with the below contents and run it

Credits : @[Shubham Londhe](@ShubhamLondhe)

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258859455/5ad8ee0e-70fe-49e2-9aae-4e9b83d5650a.webp align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258867749/e2288f96-d7a1-40de-b0b9-ec5ba73f1f86.webp align="center")

Create a Vim/Nano file and paste it and run the file

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258888905/be9fc3d8-ea43-4937-a11e-e552a38b8609.webp align="center")

It should look like this and the state needs to be actively running

Now go to VS Code and create these

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258912577/d5eb268e-e8ba-4c6d-a6ad-7356ac610c57.webp align="center")

These are the commands used to install nginx

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258931754/c0b2c29d-2d7b-4064-85ae-1155623120dc.webp align="center")

Now as before we have created a buildspec.yml file for CodeBuild , similar to that we will create appspec.yml file for CodeDeploy

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258949359/c9e2400c-47f1-4b34-96f1-7de461d1d839.webp align="center")

Now go to the terminal and use git commands to push them to the server

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258971554/0cf8985d-01f4-4ade-b572-a335464b36a3.webp align="center")

After the deployment is successful , now go to CodePipeline and create a pipeline

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690258989000/e460e0ec-00ff-4aa5-aafe-339902be68ad.webp align="center")

Add storage stage

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690259007925/0cffff2c-4e43-42ff-ada5-ebd4be866e85.webp align="center")

Adding the build stage

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690259047750/106a8fd2-2751-4d84-80b9-49f44629288c.webp align="center")

Add the Deploy stage from CodeDeploy

That's it now build the pipeline and checks the status

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690259079802/63131b42-0c6b-4534-8ab2-45f3d40d9436.webp align="center")

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1690259094302/e3a61791-ae4d-4975-9edb-aabe64df3642.webp align="center")

### **Conclusion:**

In conclusion, streamlining AWS CI/CD pipeline is an important project that can significantly improve the software development process. To streamline the pipeline, it is important to follow best practices such as creating a modular and scalable architecture, automating the build, test, and deployment processes, and using tools such as AWS CodePipeline, AWS CodeBuild, and AWS CodeDeploy. Additionally, it is important to implement security and compliance measures to ensure that the pipeline is secure and meets industry standards. With proper planning and execution, streamlining the AWS CI/CD pipeline can lead to faster and more efficient software development and better-quality software.